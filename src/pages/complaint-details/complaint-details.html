<!--
  Generated template for the ComplaintDetailsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

    <ion-navbar>
        <ion-title>Complaint Details
            <button ion-button class="float-right" (click)="editComplaint()">Edit</button>
        </ion-title>
    </ion-navbar>

</ion-header>


<ion-content padding>

    <ion-card>
        <ion-card-content>
            <div>
                <span *ngIf="complaint.created_at!=null">{{complaint.created_at}}</span>
                <span *ngIf="complaint.created_at==null">Now</span>
                <span class="float-right" *ngIf="complaint.complaintType!=null">{{complaint.complaintType.name}}</span>
            </div>
            <hr>
            {{complaint.descripcion}}
        </ion-card-content>
    </ion-card>
    <div *ngIf="complaint.id!=null">
        <hr>
        <hr>
        <h4>Attachments</h4>
        <page-attachment-component (change)="saveComplaint()" [editAllowed]="true" [loggedInPost]="user"
                                   [ref_id]="complaint.id"
                                   [attachmentList]="complaint.attachments"
                                   [ref_type]="'Complaint'"></page-attachment-component>
    </div>
        <hr>
        <hr>
    <div *ngIf="complaint.complaintfiles!=null">
        <h4>Complaint Files</h4>
        <button class="float-right" ion-button (click)="complaintFile(null)">Add new Complaint file</button>
        <ion-card *ngFor="let complaintFile of complaint.complaintfiles">
            {{complaintFile.created_at}}<br>
            {{complaintFile.description}}<br>
            <img *ngIf="complaintFile.archivo!=null
            && complaintFile.archivo!=null
            && complaintFile.archivo.url!=null && ['png', 'jpeg'].indexOf(complaintFile.archivo.url.split('.')[1])"
                 src="{{complaintFile.archivo.url}}">
            <video *ngIf="complaintFile.archivo!=null
            && complaintFile.archivo!=null
            && complaintFile.archivo.url!=null && 'mp4' == complaintFile.archivo.url.split('.')[1]" controls="controls" preload="metadata" webkit-playsinline="webkit-playsinline" class="videoPlayer">
               <source src="{{complaintFile.archivo.url}}" type="video/mp4" />
            </video>
        </ion-card>

    </div>
</ion-content>
